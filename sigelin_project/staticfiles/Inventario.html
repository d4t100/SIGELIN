<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIGELIN - Inventario</title>
  <style>
    body { font-family: 'Roboto', sans-serif; margin: 0; display: flex; background: #f5f5f5; }
    aside { width: 220px; background: #D32F2F; color: white; padding: 20px; height: 100vh; }
    aside a { color: white; text-decoration: none; display: block; margin: 10px 0; }
    main { flex: 1; padding: 20px; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
    th { background: #D32F2F; color: white; }
    .alerta { color: red; font-weight: bold; }
  </style>
<script>
  // Verificar autenticaciÃ³n al cargar
  window.addEventListener('DOMContentLoaded', async () => {
    const isAuth = await auth.requireAuth();
    if (!isAuth) return;
    
    const user = auth.getUser();
    // ... cÃ³digo especÃ­fico de cada pÃ¡gina
});
</script>
</head>
<body>
  <aside>
  <h2>SIGELIN</h2>
  <a href="/dashboard.html">ğŸ“Š Panel</a>
  <a href="/equipos.html" class="active">ğŸ–¥ï¸ Equipos</a>
  <a href="/reparaciones.html">ğŸ”§ Reparaciones</a>
  <a href="/inventario.html">ğŸ“¦ Inventario</a>
  <a href="/reportes.html">ğŸ“„ Reportes</a>
  <button onclick="logout()">Cerrar sesiÃ³n</button>
</aside>
  <main>
    <h1>Inventario de Repuestos</h1>
    <table>
      <thead><tr><th>Repuesto</th><th>Cantidad</th><th>Stock mÃ­nimo</th><th>Estado</th></tr></thead>
      <tbody id="tabla"></tbody>
    </table>
  </main>

  <script>
    const token = localStorage.getItem("sigelin_token");
    if (!token) window.location.href = "/";

    async function cargarInventario() {
      const res = await fetch("http://localhost:8000/api/inventario/", {
        headers: { Authorization: "Bearer " + token }
      });
      const data = await res.json();
      const tabla = document.getElementById("tabla");
      tabla.innerHTML = data.map(r => 
        `<tr><td>${r.nombre}</td><td>${r.cantidad}</td><td>${r.stock_minimo}</td><td>${r.cantidad < r.stock_minimo ? '<span class="alerta">Bajo stock</span>' : 'OK'}</td></tr>`
      ).join('');
    }

    function logout() {
      localStorage.clear();
      window.location.href = "/";
    }

    cargarInventario();
  </script>
</body>
<script src="/static/frontend/auth.js"></script>
</html>
